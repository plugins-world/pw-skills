# 更新日志

## 2026-01-23

### 修复

移除登录超时限制，并优化 cookies 检测逻辑

**问题描述**
- 当登录失效时，浏览器会被打开用于重新认证
- 原有超时时间为 2 分钟，超时后浏览器会在 10 秒内关闭
- 如果用户需要更多时间完成登录（例如处理多因素认证），浏览器会被过早关闭
- 程序检测到旧的 cookies 就认为登录成功，导致浏览器立即关闭

**解决方案**
- 移除超时限制，浏览器会一直等待直到登录成功
- 优化 cookies 检测逻辑：
  - 第一次检测到 cookies 时，记录它们的值
  - 持续检测 cookies 是否变化
  - 如果 cookies 变化了，说明用户刚刚登录，立即返回新的 cookies
  - 如果 cookies 连续 3 次检测（6 秒）都没有变化，认为它们是有效的，返回这些 cookies
- 用户可以慢慢完成登录流程，包括多因素认证等步骤
- 登录成功后，浏览器会在 3 秒后自动关闭
- 每 60 秒会显示一次等待提示

**修改文件**
- `scripts/gemini-webapi/utils/load-browser-cookies.ts` - 移除超时限制，优化 cookies 检测逻辑
- `SKILL.md` - 更新文档，说明登录行为
