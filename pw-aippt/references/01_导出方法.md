# PPT 导出为图片

将PPT模板导出为图片，作为垫图使用。

---

## 推荐方法：PDF 转图片

最可靠的方法，保证字体正确。

### 步骤1：导出 PDF

用 **WPS / Office / Keynote** 打开 PPT，导出为 PDF：

- WPS：文件 → 输出为PDF
- Office：文件 → 导出 → PDF
- Keynote：文件 → 导出到 → PDF

> 这一步确保字体正确嵌入 PDF

### 步骤2：PDF 转图片

```bash
# Mac/Linux（需要安装 poppler）
# Mac: brew install poppler
# Ubuntu: apt install poppler-utils

# 1. 先创建输出目录
mkdir -p "输出目录"

# 2. 转图片（推荐先用150 DPI测试，大文件用300 DPI）
pdftoppm -png -r 150 "模板.pdf" "输出目录/图"

# 如果PDF很大（>10MB），建议先用低分辨率测试
# 成功后可改为 -r 300 重新生成高清版本
```

**常见问题**：
- exit code 137：降低分辨率 `-r 150`
- 中文路径：使用绝对路径

### 步骤3：重命名

```bash
cd 输出目录
for i in {01..22}; do
  [ -f "图-${i}.png" ] && mv "图-${i}.png" "图.${i}.png"
done
```

---

## 备选方法

**Mac（Keynote CLI）**：
```bash
osascript <<'EOF'
tell application "Keynote"
    activate
    open POSIX file "/路径/模板.pptx"
    delay 5
    export front document to POSIX file "/输出目录" as slide images with properties {image format:PNG}
    close front document saving no
end tell
EOF
```

**Windows（PowerShell）**：
```powershell
$ppt = New-Object -ComObject PowerPoint.Application
$presentation = $ppt.Presentations.Open("C:\路径\模板.pptx")
foreach ($slide in $presentation.Slides) {
    $slide.Export("C:\输出目录\slide$($slide.SlideIndex).png", "PNG")
}
$presentation.Close()
$ppt.Quit()
```

---

## 完整执行示例

```bash
# 1. 导出PDF（手动操作）
# 2. 转图片
mkdir -p "垫图"
pdftoppm -png -r 150 "模板.pdf" "垫图/图"

# 3. 重命名
cd "垫图"
for i in {01..22}; do [ -f "图-${i}.png" ] && mv "图-${i}.png" "图.${i}.png"; done
```

---

## 产出物

**位置**：`模板/{模板名}/图/`

**命名**：
```
图.001.png
图.002.png
图.003.png
...
```

**目录结构**：
```
模板/{模板名}/
├── 模板.pptx（原文件）
├── 模板.pdf（中间文件）
└── 图/
    ├── 图.001.png
    ├── 图.002.png
    ├── 图.003.png
    └── ...
```

---

## 故障排除

- exit code 137：降低分辨率 `-r 150`
- 中文路径：使用绝对路径
- 优先使用PDF方法，更稳定
