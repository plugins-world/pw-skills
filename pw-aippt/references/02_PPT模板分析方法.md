# PPT 模板分析方法

分析模板，输出可复用的布局库（含提示词模板）。

---

## 一、分析流程

```
1. 导出模板图片 → 2. 逐页浏览分类 → 3. 分析页面构造 → 4. 绘制ASCII框架 → 5. 定义可改/不可改区域 → 6. 编写提示词模板
```

---

## 二、页面分类

| 类型 | 特征 | 常见页面 |
|------|------|----------|
| 固定页面 | 结构固定，只换文字 | 封面、目录、过渡页、结束页 |
| 内容页面 | 保持布局，替换内容 | 模板自带的各种布局 |
| **创意页面** | **保持风格，表达自由** | **根据内容设计的新表达形式** |

---

## 三、页面构造分析

每种布局需要明确以下元素：

| 元素 | 分析内容 |
|------|----------|
| LOGO | 有无？位置？样式？ |
| 页码 | 有无？位置？格式？ |
| 标题 | 有无？位置？字体类型？字体大小？字体颜色？ |
| 副标题 | 有无？位置？字体类型？字体大小？字体颜色？ |
| 正文 | 字体类型？字体大小？字体颜色？行距？ |
| 内容区 | 位置？可放什么？ |
| 装饰元素 | 有哪些？位置？ |
| 配色方案 | 主色？辅助色？强调色？背景色？ |

### 3.1 布局类型识别（重要）

**简单布局 vs 复杂布局**：

| 布局类型 | 特征 | 字体大小范围 | 信息密度 |
|---------|------|-------------|---------|
| 简单布局 | 标题+少量内容 | 标题 36-48pt，正文 24-32pt | 低，留白多 |
| 复杂布局 | 多区域+密集信息 | 标题 20-28pt，正文 14-18pt | 高，信息多 |

**识别方法**：
1. 数一下页面有多少个独立区域（>3 个区域 = 复杂布局）
2. 看文字密度（文字占页面 >60% = 复杂布局）
3. 看字体大小（正文 <20pt = 复杂布局）

**常见错误**：
- ❌ 将复杂布局误判为简单布局，导致字体过大、信息放不下
- ❌ 没有识别出底部横幅、侧边栏等特殊区域

### 3.2 字体大小提取（关键）

**工具方法**：
1. 截图后在图片编辑软件中测量文字高度（像素）
2. 根据页面总高度（如 1080px）计算字号
3. 公式：字号(pt) ≈ 文字高度(px) / 页面高度(px) × 72

**经验值**：
- 信息密集型页面：标题 18-24pt，正文 14-18pt
- 标准内容页：标题 32-40pt，正文 20-28pt
- 封面页：主标题 48-60pt，副标题 32-40pt

**验证方法**：
生成第一张图后，对比原模板：
- 如果文字太大、放不下 → 字号减小 20-30%
- 如果文字太小、留白太多 → 字号增大 20-30%

---

## 四、可改/不可改区域定义（重要）

每种布局必须明确定义：

### 4.1 封面页

| 区域 | 可改性 | 说明 |
|------|--------|------|
| 背景色 | ❌ 不可改 | 保持原色 |
| 装饰图案（马/花纹） | ❌ 不可改 | 位置、样式完全保持 |
| LOGO | ❌ 不可改 | 样式位置保持 |
| 年份数字 | ⚠️ 可选改 | 如需更新年份 |
| **主标题** | ✅ 可改 | 替换文字内容 |
| **副标题** | ✅ 可改 | 替换文字内容 |

### 4.2 目录页

| 区域 | 可改性 | 说明 |
|------|--------|------|
| 背景/装饰 | ❌ 不可改 | 完全保持 |
| "目录CONTENTS"框 | ❌ 不可改 | 样式位置保持 |
| 章节框布局 | ⚠️ 可调整 | 可减少数量（如4→3） |
| **章节数量** | ✅ 可改 | 可删除不需要的位置 |
| **章节标题** | ✅ 可改 | 替换文字内容 |

**特殊情况：章节数量变化**

| 情况 | 错误写法 | 正确写法 |
|------|----------|----------|
| 删除（4→3） | `04：留空` | `只显示3个章节，完全删除第4个位置（包括数字和框线）` |
| 增加（3→4） | `增加一个04` | `调整为4个章节布局，保持原有样式，新增第4个位置` |

> **原则**：明确说"调整布局为X个"，不要只说"留空"或"增加"

### 4.3 章节过渡页

| 区域 | 可改性 | 说明 |
|------|--------|------|
| 背景/边框装饰 | ❌ 不可改 | 完全保持 |
| "NO.X"样式 | ❌ 不可改 | 金色渐变效果保持 |
| **编号数字** | ✅ 可改 | 如 NO.1 → NO.2 |
| **章节标题** | ✅ 可改 | 替换文字内容 |
| **英文副标题** | ✅ 可改 | 可选，替换或删除 |

### 4.4 内容页（左图右文）

| 区域 | 可改性 | 说明 |
|------|--------|------|
| 背景色 | ❌ 不可改 | 保持原色 |
| 左侧装饰区 | ❌ 不可改 | 插画/图案保持 |
| 整体布局比例 | ❌ 不可改 | 左右分割保持 |
| LOGO | ❌ 不可改 | 位置样式保持 |
| **标题** | ✅ 可改 | 替换文字 |
| **要点内容** | ✅ 可改 | 替换文字，数量可变 |

### 4.5 内容页（左图右列表）

| 区域 | 可改性 | 说明 |
|------|--------|------|
| 背景/装饰 | ❌ 不可改 | 完全保持 |
| 卡片样式 | ❌ 不可改 | 边框、圆角保持 |
| **标题** | ✅ 可改 | 替换文字 |
| **列表项** | ✅ 可改 | 替换文字，数量可变 |

### 4.6 结束页

| 区域 | 可改性 | 说明 |
|------|--------|------|
| 所有装饰 | ❌ 不可改 | 与封面一致 |
| **主文字** | ✅ 可改 | 替换感谢语 |
| **副文字** | ✅ 可改 | 替换补充语 |

### 4.7 创意页面

**核心原则**：**风格不变，表达自由**

| 区域 | 可改性 | 说明 |
|------|--------|------|
| 视觉风格 | ❌ 不可改 | 配色、装饰、字体、背景 |
| **表达形式** | ✅ 可改 | 流程图/时间轴/对比表/金句/图表... |

**适用场景**：模板现有布局无法最佳表达内容时

**设计流程**：
1. 分析内容的最佳表达形态（流程图？对比表？金句？时间轴？）
2. 从模板提取视觉约束（主色、装饰风格、字体风格）
3. 在约束内设计新表达形式
4. 选择风格最接近的模板页作为垫图参考

**常见创意形态**：

| 内容类型 | 表达形式建议 |
|----------|--------------|
| 步骤/流程 | 流程图、时间轴、箭头连接 |
| 对比/优劣 | 天平图、表格、左右对照 |
| 核心金句 | 大字居中、引用框、背景装饰 |
| 数据/统计 | 图表、数字高亮、信息图 |
| 层级关系 | 金字塔、树状图、环形图 |

**提示词模板**：
```
{垫图URL} 参考这张PPT模板的视觉风格，设计一个新页面。
【不可改区域】（严格保持原样）
- 视觉风格：配色、装饰、字体、背景与模板一致
【可改区域】
- 表达形式：{流程图/时间轴/对比表/金句/...}
- 内容：{具体内容}

【生成指令】
absolutely no watermark, clean output only
```

---

## 五、输出格式

每种布局按此格式整理：

```markdown
### {布局名称}

**ASCII 框架**
```
┌─────────────────────────────────────────┐
│                                         │
│           （画出实际布局）                 │
│                                         │
└─────────────────────────────────────────┘
```

**页面构造**
| 元素 | 有无 | 位置 | 说明 |
|------|------|------|------|
| LOGO | ✓ | 左上 | 带箭头装饰 |
| ... | ... | ... | ... |

**可改/不可改区域**
| 区域 | 可改性 | 说明 |
|------|--------|------|
| 背景装饰 | ❌ 不可改 | 完全保持 |
| 标题文字 | ✅ 可改 | 替换内容 |
| ... | ... | ... |

**适用场景**：{什么内容适合用这个布局}

**垫图**：`图/图.00X.png`

**提示词模板**：
```
{垫图URL} 参考这张PPT模板，生成新页面。
【不可改区域】（严格保持原样）
- 背景色、装饰图案、LOGO位置
- 字体类型：标题使用{字体名称}，正文使用{字体名称}
- 字体颜色：标题{颜色值}，正文{颜色值}，强调文字{颜色值}
- 配色方案：主色{颜色值}，辅助色{颜色值}
【可改区域】
- 主标题：{主标题}
- 副标题：{副标题}

【生成指令】
absolutely no watermark, clean output only
```
```

---

## 六、提示词编写规范

### 6.1 基本结构

提示词分两部分：**内容描述** + **生成指令**

```
{垫图URL} 参考这张PPT模板，生成新页面。
【不可改区域】（严格保持原样）
- {列出所有不能改的元素}
【可改区域】
- {列出要替换的内容}

【生成指令】
absolutely no watermark, clean output only
```

> **说明**：`【生成指令】` 是给AI的命令，不会显示在图片上。放在最后，与内容空一行隔开。

### 6.2 删除元素的写法

当需要删除模板中的某些元素时：

```
# 错误写法
04：留空
04：（空）
04位置不显示

# 正确写法
只显示3个章节，完全删除第4个位置（包括数字和框线）
布局调整为只有3个格子
```

### 6.3 数量变化的写法

```
# 要点从3个变2个
【可改区域】
- 要点数量：只显示2个要点
- 要点1：xxx
- 要点2：xxx
```

### 6.4 字体和颜色约束（重要）

**字体类型约束**：

中文 PPT 必须明确指定中文字体，否则 AI 可能使用英文字体导致风格不一致。

```
# 常见中文字体
- 标题：黑体、微软雅黑、思源黑体
- 正文：宋体、微软雅黑、思源宋体
- 强调：黑体（加粗）

# 提示词写法
【不可改区域】
- 字体类型：标题使用黑体，正文使用宋体
- 所有中文文字必须使用中文字体，不使用英文字体
```

**字体颜色约束**：

必须明确指定所有文字的颜色，包括色值（如 #E74C3C）。

```
# 提示词写法
【不可改区域】
- 字体颜色：
  - 标题：红色（#E74C3C）
  - 正文：黑色（#333333）
  - 强调文字：红色（#E74C3C）
  - 作者信息：浅灰色（#999999）
```

**配色方案约束**：

除了文字颜色，还要约束整体配色方案。

```
# 提示词写法
【不可改区域】
- 配色方案：
  - 主色：红色（#E74C3C）
  - 辅助色：粉红色（#F8B4B4）
  - 背景色：白色（#FFFFFF）或红粉渐变
  - 强调色块：红色（#E74C3C）
```

### 6.6 Logo 和品牌元素处理（重要）

**问题**：AI 可能误解"删除 Logo"的指令，用占位文字（如 "brand logo"、"logo"）来标记位置。

**正确写法**：

```
# 错误写法
- 删除右上角 Logo
- 右上角 Logo 删除

# 正确写法
- 右上角 Logo 处理：完全删除 "XX品牌" Logo，该区域保持空白，不显示任何内容（包括 "brand logo"、"logo" 等占位文字或标记）
```

**统一策略**：

所有页面的 Logo 处理必须保持一致：
- 要么所有页面都完全删除 Logo 区域（留空）
- 要么所有页面都保留原 Logo
- 要么所有页面都替换为统一的新 Logo

**提示词模板**：

```
【可改区域】
- 右上角 Logo 处理：完全删除 "{原品牌名}" Logo，该区域保持空白，不显示任何内容（包括 "brand logo"、"logo" 等占位文字或标记）
```

### 6.7 生成指令（必须）

所有提示词末尾都要加 `【生成指令】` 段落：

```
【生成指令】
absolutely no watermark, clean output only
```

**作用**：告诉AI不要生成水印或多余文字。这是命令，不是内容。

---

## 七、产出物

**位置**：用户指定文件夹

**命名**：`02-模板分析-v1.md`

---

## 八、风格提取规范

分析模板时，必须提取以下风格要素，形成标准化的风格定义文档。

### 8.1 设计美学 (Design Aesthetic)

描述整体视觉风格和核心设计理念。

**提取要点**:
- 整体风格定位 (简洁/商务/手绘/技术/创意等)
- 核心设计理念 (专业/活泼/严谨/创新等)
- 视觉特征 (扁平化/拟物化/渐变/手绘等)

**示例**:
```
设计美学: 现代商务风格，强调专业性和清晰度
核心理念: 信息层级清晰，视觉简洁大方
视觉特征: 扁平化设计，使用几何图形装饰
```

### 8.2 背景系统 (Background)

精确记录背景的颜色、纹理和图案。

**提取要点**:
- 背景颜色 (必须提供精确 Hex 值)
- 渐变信息 (起始色、结束色、方向、位置)
- 纹理/图案描述 (纸张纹理、网格、几何图案等)

**示例**:
```
背景颜色: 纯白色 (#FFFFFF)
纹理: 无
```

或

```
背景颜色: 暖米白 (#FAF8F0)
纹理: 细腻的纸张纹理
渐变: 从左上 #FAF8F0 到右下 #F5F3ED
```

### 8.3 字体系统 (Typography)

明确标题和正文的字体规范。

**提取要点**:
- 标题字体: 字体名称、粗细、大小范围、颜色 Hex 值
- 正文字体: 字体名称、粗细、大小范围、颜色 Hex 值
- 小标题字体: 字体名称、粗细、大小范围、颜色 Hex 值
- 对齐方式: 居中/左对齐/右对齐

**示例**:
```
标题字体:
- 字体: 黑体 (Heiti)
- 粗细: Bold (700)
- 大小: 48pt
- 颜色: 深灰 (#334155)

正文字体:
- 字体: 宋体 (SimSun)
- 粗细: Regular (400)
- 大小: 24pt
- 颜色: 中灰 (#64748B)
```

### 8.4 颜色系统 (Color Palette)

必须以表格形式记录完整的颜色系统。

**提取要点**:
- 每个颜色的角色 (背景/主文本/强调色等)
- 颜色名称 (便于理解)
- 精确的 Hex 值
- 具体用途说明

**表格格式**:

| 角色 | 颜色名 | Hex 值 | 用途 |
|------|--------|--------|------|
| 背景 | 纯白 | #FFFFFF | 主背景 |
| 主文本 | 深灰 | #334155 | 标题、重要文字 |
| 次要文本 | 中灰 | #64748B | 正文、说明文字 |
| 强调色 | 红色 | #DC2626 | 重点标注、装饰元素 |
| 辅助色 | 浅红 | #FEE2E2 | 背景色块、边框 |
| 页码/作者 | 浅灰 | #94A3B8 | 页码、作者信息 |

### 8.5 视觉元素 (Visual Elements)

列出所有装饰元素及其位置和样式。

**提取要点**:
- LOGO (位置、大小、样式)
- 页码 (位置、字号、颜色)
- 图标 (位置、样式、颜色)
- 边框/色块 (位置、大小、颜色)
- 分隔线 (位置、粗细、颜色)
- 其他装饰元素

**示例**:
```
视觉元素清单:
- LOGO: 左上角，红色心形图标，尺寸 60x60px
- 页码: 右下角，18pt 浅灰色 (#94A3B8)
- 装饰图标: 左上角红色圆形装饰，直径 80px
- 横幅: 底部红色装饰条，高度 20px
- 边框: 内容区域浅灰色边框，1px 粗细
```

### 8.6 风格约束 (Style Rules)

明确列出必须保持和禁止改变的规则。

**应该保持** (Do):
- 列出必须保持的视觉特征
- 确保风格一致性的关键要素

**禁止改变** (Don't):
- 列出绝对不能改变的元素
- 通用禁止项 (适用于所有风格)

**示例**:
```
应该保持:
- 保持一致的线条粗细 (1px 或 2px)
- 使用网格对齐，确保元素整齐排列
- 保持统一的圆角半径 (8px)
- 保持一致的留白比例 (上下左右各 5%)

禁止改变:
- 不添加幻灯片编号 (除非模板原有)
- 不添加页脚文字 (除非模板原有)
- 不使用与风格不符的装饰元素
- 不改变背景颜色
- 不使用模板外的颜色
```

### 8.7 最适合场景 (Best For)

说明该风格最适合的使用场景。

**示例**:
```
最适合场景:
- 企业内部培训材料
- 商务汇报演示
- 产品发布会
- 年度总结报告
```

### 8.8 风格提取输出格式

每个模板分析完成后，必须输出标准化的风格定义文档。

**文档结构**:

```markdown
# {模板名} 风格定义

## 设计美学
{整体设计美学描述}

## 背景系统
- 颜色: {精确 Hex 值}
- 纹理: {纹理描述}
- 渐变: {渐变信息}

## 字体系统

### 标题字体
- 字体: {字体名称}
- 粗细: {粗细}
- 大小: {大小}
- 颜色: {Hex 值}

### 正文字体
- 字体: {字体名称}
- 粗细: {粗细}
- 大小: {大小}
- 颜色: {Hex 值}

## 颜色系统

| 角色 | 颜色名 | Hex 值 | 用途 |
|------|--------|--------|------|
| ... | ... | ... | ... |

## 视觉元素
- {元素列表}

## 风格约束

### 应该保持
- {保持的特征列表}

### 禁止改变
- 不添加幻灯片编号、页脚或 Logo (除非模板原有)
- {其他禁止项}

## 最适合场景
- {使用场景列表}
```

---

## 九、输出文档结构

```markdown
# {模板名} 模板分析

## 模板概览
- 总页数：XX 页
- 风格：{风格描述}
- 主色：{主色}
- 固定页面：P1(封面)、P2(目录)...
- 内容页布局：X 种

## 风格定义

（按照 8.8 风格提取输出格式填写）

## 布局库

### 封面页

**ASCII 框架**
（绘制）

**页面构造**
| 元素 | 有无 | 位置 | 说明 |
|------|------|------|------|
| ... | ... | ... | ... |

**可改/不可改区域**
| 区域 | 可改性 | 说明 |
|------|--------|------|
| ... | ... | ... |

**适用场景**：PPT开头

**垫图**：`图/图.001.png`

**提示词模板**：
（填写）

---

### 目录页
...

### 内容页 - {布局特征}
...

### 创意页面（按需添加）

**核心原则**：风格不变，表达自由

**可改/不可改区域**
| 区域 | 可改性 | 说明 |
|------|--------|------|
| 视觉风格 | ❌ 不可改 | 配色、装饰、字体、背景 |
| 表达形式 | ✅ 可改 | 根据内容选择最佳形式 |

**适用场景**：模板现有布局无法最佳表达时

**垫图**：选择风格最接近的模板页

**提示词模板**：
（见 4.7 创意页面）
```
